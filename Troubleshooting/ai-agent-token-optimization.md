# 🚧 AI Agent 개발 트러블슈팅 로그  
> Claude Pro 플랜 토큰 한계 극복 및 모델 병행 전략 수립 기록  
> 작업 효율화 중심 트러블 슈팅 문서

---

## 📌 개요
AI 에이전트 개발 과정에서 Claude Pro 플랜을 사용하며 **토큰 사용량 초과로 인한 작업 중단 문제**를 반복적으로 경험하였다.  
이를 계기로 작업 단위를 재설계하고, Claude와 ChatGPT를 **기능·역할 기반으로 분리한 멀티 모델 전략**을 도입해 작업 안정성과 효율을 크게 개선하였다.

---

## 🧩 문제 상황 (Problem)

### 1. Claude Pro 토큰 제한에 잦은 충돌
- 체크리스트 생성 → 세부 작업 실행 → 파일 생성까지 단일 모델에서 수행  
- 한 요청에서 대량의 컨텍스트 누적으로 토큰 초과 발생  
- 반복적인 응답 실패 및 코드 실행 중단 문제 발생

### 2. 작업 단위 미분리로 인한 토큰 낭비
- “모두 다 맡겨버리는 방식”의 자동화  
- 매 단계에서 전체 문맥 재분석 → 불필요한 토큰 지속 소모  
- 간단한 작업도 대규모 모델이 수행하게 되어 효율성 저하

### 3. Agent 활용 방식의 비효율성
- 에이전트에 전체 업무를 맡기는 구조  
- 요구사항 혼재 → 명령 중복 → 토큰 과다 사용  
- Pro 플랜은 코드·파일 작업 중심 워크플로우와 충돌

---

## 🔍 원인 분석 (Root Cause)

1. **작업 단위 세분화 부족**  
   → 모든 작업을 단일 Agent에 위임하는 구조로 설계됨

2. **Pro 플랜의 토큰 한계 구조 고려 부족**  
   → Claude Code 환경은 파일 생성 및 코드 기반 작업에서 토큰 소모량 상승

3. **모델 역할 구분의 부재**  
   → 모델에 맞는 작업 분리가 이루어지지 않아 리소스 낭비로 이어짐

4. **대규모 문맥 기반 자동화와 플랜 스펙 간 불일치**  
   → 전체 워크플로우를 단일 모델에서 처리하기에 스펙이 불충분

---

## 💡 해결 전략 (Solution)

### ✅ 1. 멀티 모델 병행 전략 구축
- **Claude Code**
  - 코드 생성  
  - 파일 작성  
  - 구조화된 작업  
- **ChatGPT**
  - 체크리스트 실행  
  - 오류 해결  
  - 보조 작업 및 문서 정리  

→ 모델 역할을 분리해 토큰 소비는 최소화하고 정확도·안정성은 유지

---

### ✅ 2. Atomic Task 기반 작업 분할
- 작업을 체크리스트 기반으로 분리 수행  
- Claude에는 필요한 지시만 전달하여 불필요한 문맥 제거  
- ChatGPT를 통해 중간 과정 요약 후 Claude에 전달하는 방식 도입

---

### ✅ 3. 토큰 사용 관리 기준 확립
- 토큰 폭증 시 Claude 작업 중단 → GPT로 전환  
- 불필요한 히스토리 제거 후 재요청  
- 요약·정제·이관 단계를 명확하게 규정

---

### ✅ 4. 에이전트 설계를 협업 구조로 재구성
- 단일 엔드포인트 방식 제거  
- **Core Agent → Sub Task Agents → Reviewer** 구조 적용  
- 참고 자료 기반으로 효율적인 협업형 Agent 구성 설계  
  > https://lilys.ai/digest/7231265/7759343?s=1&noteVersionId=4175864

---

## 📈 적용 결과 (Outcome)

- **토큰 사용량 40~60% 절감**
- **응답 안정성 향상**: 중간 실패율 감소
- **작업 속도 개선**: 불필요한 컨텍스트 분석 제거  
- **멀티 모델 전략 정착**: 모델별 최적 역할 기반 운영  
- **Agent 협업 구조 확립**: Worker 기반의 안정적 설계 패턴 확인

---

## ✨ 인사이트 (Key Learnings)

- AI 모델은 “만능 자동화 시스템”이 아니라 **역할 기반으로 배치되는 협업자**  
- 모델별 strengths를 고려한 설계가 **비용 효율성과 안정성**의 핵심  
- 토큰은 중요한 개발 자원이며 관리 기준이 반드시 필요  
- 에이전트는 작업 전부가 아니라 **작업 단위별로 활용해야 성능이 극대화됨**

---

## 📚 참고 자료
- 효율적 에이전트 설계 레퍼런스  
  https://lilys.ai/digest/7231265/7759343?s=1&noteVersionId=4175864

---

## 📝 포트폴리오 요약 문장 (Short Summary)
> Claude Pro 플랜 환경에서 대규모 자동화를 수행하던 중 토큰 제약 문제를 경험했고,  
> 이를 해결하기 위해 모델별 역할을 분리하는 멀티 모델 전략을 도입했다.  
> 작업 단위를 세분화하고 토큰 관리 기준을 정의하여 작업 안정성과 속도를 모두 개선하였으며,  
> 에이전트를 협업자처럼 활용하는 설계 철학을 확립하게 되었다.

